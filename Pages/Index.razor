@page "/"
@using BlazorStyled
@using DataJuggler.UltimateHelper 
@using DataJuggler.Blazor.Components
@using DataJuggler.Blazor.FileUpload
@using DataJuggler.Blazor.Components.Enumerations
@using System.Drawing

<Styled @bind-Classname="DownloadLink">    
    color: white;
    background: none!important;
    border: none;
    padding: 0!important;
    font-family: Verdana;
    text-decoration: none;
    cursor: pointer;    
    height: 1.5vh;
    line-height: 1.5vh;
    font-size: 12px;
    font-weight: normal;
    position: fixed;    
    display: inline;
    left: 2.8%;
    margin-top: .4vh;
</Styled>
<Styled @bind-Classname="DownloadLink2">    
    background: none! important;
    border: none;
    padding: 0 !important;
    font-family: Verdana;
    text-decoration: none;
    cursor: pointer;    
    height: 1.5vh;
    line-height: 1.5vh;
    font-size: 12px;
    font-weight: normal;
    position: relative;    
    display: inline-block;
    left: 114%;
    top: .4vh;
    margin-top: .4vh;
    z-index: 41;
</Styled>
<Styled @bind-Classname="Grid">
    display: inline-block;
    height: auto;
    width: 80%;
    font-size: 12px;
    position: relative;
    left: -12%;
    top: 8vh;
</Styled>
<Styled @bind-Classname="Instructions">
    font-size: 1em;
    line-height: 1em;
    color: white;
    position: fixed;
    top: 40vh;
    left: 26%;
    display: @InstructionsDisplay;
    z-index: 52;
</Styled>
<Styled @bind-Classname="OrangeButton">
    position: fixed;
    background-color: transparent;
    border: 0px;
    outline: none;
    background-image: url('../images/OrangeButton.png');
    background-repeat: no-repeat;
    top: 23vh;
    left: 26.8%;
    width: 10%;
    height: 3.6%;
    background-size: 100% 100%;    
    cursor: pointer;
    text-align: center;
    font-size: 12px;
</Styled>
<Styled @bind-Classname="SelectClasses">
    display: @DisplayStyle;
    width: 20%;
    height: 6vh;
    position: fixed;
    top: 8.8vh;    
    z-index: 40;   
</Styled>
<Styled @bind-Classname="SideBarElementText">
    text-align: center;
    font-family: Verdana;
    font-size: 14px;
    font-weight: bold;
</Styled>
<Styled @bind-Classname="SideBarSmallText">
    text-align: left;
    font-family: Verdana;
    font-size: 12px;
    font-weight: normal;
</Styled>
<Styled @bind-Classname="SideBarLargeText">
    text-align: left;
    font-family: Verdana;
    font-size: 13px;
    font-weight: normal;
</Styled>
<Styled @bind-Classname="SideBarLargeTextBold">
    text-align: left;
    font-family: Verdana;
    font-size: 13px;
    font-weight: bold;
</Styled>
<Styled @bind-Classname="Slogan">
    font-family: Verdana;
    font-size: 2.8vh;
    position: absolute;
    top: 8.4vh;
    left: .4%;
    white-space: nowrap;    
</Styled>
<Styled @bind-Classname="Smallheader">
    font-weight: bold;
    font-size: 13px;
</Styled>
<Styled @bind-Classname="StatusStyle">  
    text-align: center;
    position: absolute;
    top: 16vh;
    left: -4%;
    width: 60%;
    height: 2.8vh;
    line-height: 2.8vh;
    font-size: 16px;
    color: @LabelColor;
</Styled>
<Styled @bind-Classname="VersionStyle">
    position: fixed;
    right: 4%;
    top: 2vh;
    color: white;
    font-size: 14px;
</Styled>

<div class="sidebar">
    <div class="sidebarelement">
       <div class="@SideBarElementText">
            Downloads
        </div>
        <div class="displayinline">
            <div class="smallicon">
                <a class="@DownloadLink" download="MemberData.xlsx" href="@SampleMemberDataPath" target="_blank">MemberData.xlsx</a>
            </div>
            <div class="@SideBarSmallText">
                Sample workbook with random data for testing:<br />
                Members (20,000)<br />
                Address (20,000)<br />
                States (51)
            </div>
            <br />
            <div class="blankline"></div>
            <div class="blanklinesmall"></div>
            <div class="@SideBarLargeTextBold">
                Want the source code?<br />
            </div>
            <div class="@SideBarSmallText text-nowrap">
                <div class="blanklinesmall"></div>
                <span class="text-nowrap">
                    <a class="whitetext" href="https://github.com/DataJuggler/Blazor.Excelerate" target="_blank">Blazor.Excelerate</a><br />
                </span>
                <div class="blanklinesmall"></div>
                <span class="text-nowrap">
                    <a class="whitetext" href="https://github.com/DataJuggler/Excelerate" target="_blank">DataJuggler.Excelerate</a><br />
                </span>
                <div class="blanklinesmall"></div>
                <span class="text-nowrap">
                    <a class="whitetext" href="https://github.com/DataJuggler/Excelerate.WinForms.Demo" target="_blank">Excelerate.WinForms.Demo</a><br />
                </span>
                <div class="blanklinesmall"></div>
                <span class="text-nowrap">
                    <a class="whitetext" href="https://github.com/DataJuggler/DataJuggler.Blazor.Components" target="_blank">DataJuggler.Blazor.Components</a><br />
                </span>
                <div class="blanklinesmall"></div>
                <span class="text-nowrap">
                    <a class="whitetext" href="https://github.com/DataJuggler/BlazorFileUpload" target="_blank">DataJuggler.Blazor.FileUpload</a><br />
                </span>
                <div class="blanklinesmall"></div>
                <span class="text-nowrap">
                    <a class="whitetext" href="https://github.com/DataJuggler/UltimateHelper" target="_blank">DataJuggler.UltimateHelper</a><br />
                </span>
                 <div class="blanklinesmall"></div>
                <span class="text-nowrap">
                    <a class="whitetext" href="https://github.com/chanan/BlazorStyled/" target="_blank">Chanan/BlazorStyled</a><br />
                </span>
                <div class="blankline"></div>
                <div class="blankline"></div>
                <div class="@SideBarLargeTextBold">
                    Worth the price (free)?<br />
                </div>
                <div class="blanklinesmall"></div>
                <div>
                    <span class="@SideBarLargeText">
                        Please leave stars on<br />
                        Git Hub and subscribe<br />
                        to my YouTube channel.
                    </span>
                </div>
                <div class="blanklinesmall"></div>
                <a href="https://youtube.com/DataJuggler" target="_blank">
                    <div class="bottomsidebar"></div>
                </a>
            </div>
        </div>        
    </div>    
</div>
<Sprite Name="Logo" Parent="this" Height="10.8" Width="8.4"
        XPosition="2.68" YPosition="2" Visible="true" Position="fixed" 
        Subscriber=this ImageUrl="../images/ExcelerateLogoSmallWhite.png"></Sprite>
<div class="topbar">
    <div class="logotext">
    </div>
    <div class="@Slogan">
        Code Generate C# Classes From Excel Header Rows
    </div>
</div>
<div class="topright">
    <div class="@VersionStyle">
        Version 1.7.0
    </div>    
    <a class="noborder" href="https://datajuggler.com"><div class="businesscard"></div></a>
</div>
<div class="contentmain">
    <div class="@SelectClasses">
        <ComboBox OnChange="SheetSelected" Parent="this" Name="SheetNamesComboBox" Theme=ThemeEnum.Blue
            LabelColor="Color.White" Position="relative" Visible="true" Left="52" Top="10.8" ZIndex="40" VisibleCount="6"            
            Width="160" LabelMarginRightList="2.4" ButtonTextColor="Color.Black" HeightUnit="vh" Height="16"
            LabelText="Sheets:">
        </ComboBox>   
     </div>
    <div class="row displayinline contentmaintoprow">
        <ValidationComponent Name="NamespaceComponent" Caption="Namespace:" LabelFontSizeUnit="vh" LabelFontSize="2"
            Position="relative" Unit="%" HeightUnit="vh" Height="3" LabelColor="white" Top="14.8" Left="-14" 
            IsRequired="true" Width="8" LabelWidth="30" TextBoxWidth="44" LabelClassName="down4" Parent="this">
        </ValidationComponent>            
    </div>     
     <div>
        <div class="row">                
            <ImageButton ButtonNumber="2" ButtonText="Generate Class" Name="GenerateClassesButton"
                Left="42" Top="22.8" Height="4" Position="fixed" ZIndex="41"
                Width="120" ImageUrl="@ButtonUrl" Parent="this"></ImageButton>    
        </div>
    </div>
    <div>
        <div class="row">                 
            <FileUpload CustomSuccessMessage="Your file uploaded successfully." 
                OnReset="OnReset" ResetButtonClassName="localbutton" ShowStatus="false"
                PartialGuidLength="12" MaxFileSize=@UploadLimit FilterByExtension="true" 
                ShowCustomButton="true"  ButtonText="Upload Excel" OnChange="OnFileUploaded"
                CustomButtonClassName="@OrangeButton" AllowedExtensions=".xlsx"
                ShowResetButton="false" AppendPartialGuid="true"
                CustomExtensionMessage="Only .xlsx extensions are allowed." 
                InputFileClassName="customfileupload" Visible=false Status="Refresh"
                FileTooLargeMessage=@FileTooLargeMessage>
            </FileUpload>
        </div>
    </div>    
    <div class="@StatusStyle">
        <label class="text-center">@Status</label>
    </div>
    @if ((HasResponse) && (Response.Success) && (Response.HasFileName) && (Response.HasFullPath))
     { 
         <div class="smallicon2 text-white text-nowrap">
            <a class="@DownloadLink2 downloadlink2hover" download="@Response.FileName" href="@DownloadPath" target="_blank">@Response.FileName</a><br />
            <span class="small text-white movedownsmall">
                 Browsers do not allow downloading files with .cs extensions, so download this zip file and extract to a folder.
            </span>
        </div>
    }
    <div class="@Instructions">
        <div class="@Grid">
            <div class="column instructionscolumn1">
                <ImageButton ButtonNumber="3" ButtonText="Hide" Name="HideInstructionsButton"
                    TextSize="TextSizeEnum.Large" Height="4" ZIndex="52"
                    Width="120" ImageUrl="../Images/OrangeButton.png" Parent="this"></ImageButton>
            </div>
            <div class="column instructionscolumn2">
                <div class="marginsmall @Smallheader">Instructions</div>
                <div class="blankline"></div>
                1. Prepare your spreadsheet (save as .xlsx extension) and ensure you have a header row, and the 
                column names make good property names. Download MemberData.xlsx to see an example.<br />
                2. Upload your spreadsheet and select the sheet to code generate a class for.<br />
                3. Type in a namespace for your project and click the 'Generate Class' button.<br />
                4. Download the zip file and extract the contents to get your .cs file.<br />
                <div class="blankline"></div>
                <div class="marginsmall @Smallheader">Tips / Troubleshooting</div>
                <div class="blankline"></div>
                It helps to have some rows of data to attempt to determine the data type. Getting the data type is kind of a hack,
                as I could not find away with EPP Plus to get the column data types.<br />
                <div class="blankline"></div>
                <div class="blankline"></div>
                If you have a problem generating classes, create an issue here or to clone or star:<br />
                <a class="orangetext" href="https://github.com/DataJuggler/Excelerate">DataJuggler.Excelerate Git Hub</a><br />
                <div class="blankline"></div>
                If you have a problem with this site, create an issue here or to clone or star:<br />
                <a class="orangetext" href="https://github.com/DataJuggler/Blazor.Excelerate">Blazor.Excelerate Git Hub</a><br />
                <div class="blankline"></div>
                <div class="marginsmall @Smallheader">Data Privacy</div>
                <div class="blankline"></div>
                No one has access to my server except me and my dog.<br />
                I am building a Windows Service that deletes files older than one hour.<br />
                This will be deployed in the next couple of weeks (estimate 12.31.2022).
            </div>
        </div>
    </div>
</div>
<div class="progresscontainer">
    <ProgressBar Subscriber=this Increment="1" Interval="25" ClientHandledIncrement="false" 
         CloseAtExtraPercent="20" Visible="@ShowProgress" Theme=ThemeEnum.Dark Color=ColorEnum.Orange
         Size=SizeEnum.Small OverrideThemeColorForText="true" TextColor="White">
    </ProgressBar>
</div>

    



